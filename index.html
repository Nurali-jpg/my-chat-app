<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Chat App</title>
</head>
<body>
    <h1>Welcome to Simple Chat!</h1>
    <div id="chat-window"></div>
    <input type="text" id="message-input" placeholder="Type a message">
    <button onclick="sendMessage()">Send</button>
    
	<!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>

    <script>
      // Firebase configuration
      const firebaseConfig = {
  apiKey: "AIzaSyB_y9YYVJMFIAW_uOoJ5HAAupllEckw4E8",
  authDomain: "test0-e7c10.firebaseapp.com",
  projectId: "test0-e7c10",
  storageBucket: "test0-e7c10.appspot.com",
  messagingSenderId: "383308995691",
  appId: "1:383308995691:web:704d81923b0e512d09252e",
  measurementId: "G-74N8R0BRS0"
};

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      // Initialize Firestore
      const db = firebase.firestore();
	  
	   // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
  function sendMessage() {
    const messageInput = document.getElementById('message-input');
    const messageText = messageInput.value;

    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð½Ðµ Ð¿ÑƒÑÑ‚Ð¾Ðµ
    if (messageText.trim() !== "") {
      // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð² ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑŽ "messages" Ð² Firestore
      db.collection('messages').add({
        text: messageText,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      }).then(() => {
        messageInput.value = ''; // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ðµ Ð²Ð²Ð¾Ð´Ð° Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸
      }).catch(error => {
        console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: ", error);
      });
    }
  }
  
  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
  db.collection('messages').orderBy('timestamp').onSnapshot(snapshot => {
    const chatWindow = document.getElementById('chat-window');
    chatWindow.innerHTML = ''; // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ñ‡Ð°Ñ‚ Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¾Ð¹ Ð½Ð¾Ð²Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹

    // Ð”Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð² Firestore
    snapshot.forEach(doc => {
      const messageData = doc.data();
      
      // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
      const messageDiv = document.createElement('div');
      messageDiv.textContent = messageData.text; // Ð’ÑÑ‚Ð°Ð²Ð»ÑÐµÐ¼ Ñ‚ÐµÐºÑÑ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
      chatWindow.appendChild(messageDiv); // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð² Ñ‡Ð°Ñ‚
    });
  });
  
   // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ñ€ÐµÐ°ÐºÑ†Ð¸Ð¸ Ðº Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¼Ñƒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑŽ
  function addReaction(messageId, emoji) {
    db.collection('messages').doc(messageId).collection('reactions').add({
      emoji: emoji,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    }).catch(error => {
      console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ Ñ€ÐµÐ°ÐºÑ†Ð¸Ð¸: ", error);
    });
  }

  // Ð˜Ð·Ð¼ÐµÐ½ÑÐµÐ¼ onSnapshot Ð´Ð»Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº Ñ Ñ€ÐµÐ°ÐºÑ†Ð¸ÑÐ¼Ð¸
  db.collection('messages').orderBy('timestamp').onSnapshot(snapshot => {
    const chatWindow = document.getElementById('chat-window');
    chatWindow.innerHTML = '';

    snapshot.forEach(doc => {
      const messageData = doc.data();
      const messageId = doc.id; // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ

      const messageDiv = document.createElement('div');
      messageDiv.textContent = messageData.text;

      // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´Ð»Ñ Ñ€ÐµÐ°ÐºÑ†Ð¸Ð¹
      const reactionButton1 = document.createElement('button');
      reactionButton1.textContent = 'ðŸ‘';
      reactionButton1.onclick = () => addReaction(messageId, 'ðŸ‘');

      const reactionButton2 = document.createElement('button');
      reactionButton2.textContent = 'ðŸ˜‚';
      reactionButton2.onclick = () => addReaction(messageId, 'ðŸ˜‚');

      messageDiv.appendChild(reactionButton1);
      messageDiv.appendChild(reactionButton2);

      chatWindow.appendChild(messageDiv);
    });
  });
  
  
    </script>
</body>
</html>